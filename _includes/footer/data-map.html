{%- capture zoom -%}{%- if page.zoom and zoom != '' -%}{{ page.zoom }}{%- else -%}8{%- endif -%}{%- endcapture -%}
{%- assign breadcrumb = page.breadcrumb | replace: "'", "&prime;" -%}
{%- if data and pageu contains '/map.html' -%}
  {%- include {{ data }} -%}
  {%- if offers.size > 0 -%}
    <script>var map = L.map('map',{center:[{{ page.coordinates }}],minZoom:8,zoom:8}).setView([{{ page.coordinates }}],{{ zoom }}); var markers = [{%- for offer in offers -%}{%- assign names = offer.seller | replace: "'", "&prime;" -%}[{{ offer.coordinates | split: ',' | first }},{{ offer.coordinates | split: ',' | last }},'{%- if offer.rent and offer.rent == "1" -%}{{ site.data.uk.re_for_rent }}{%- else -%}{{ site.data.uk.re_for_sale }}{%- endif -%}','{{ offer.type | downcase }}',{%- if offer.surface and offer.surface != '' -%}{{ offer.surface }}{%- else -%}{{ offer.surface_land }}{%- endif -%},{{ offer.rooms | default: '0' }},'{%- include footer/floor.html floor=offer.floor floors=offer.floors -%}',{%- if offer.rent == '1' and offer.price_sqmt != '' -%}{%- if offer.price_sqmt contains '$' and offer.price_sqmt != '' -%}{{ offer.price_sqmt | remove: '$' | times: site.usd | ceil }}{%- elsif offer.price_sqmt contains '€' and offer.price_sqmt != '' -%}{{ offer.price_sqmt | remove: '€' | times: site.eur | ceil }}{%- else -%}{{ offer.price_sqmt }}{%- endif -%}{%- else -%}{%- if offer.price contains '$' and offer.price != '' -%}{{ offer.price | remove: '$' | times: site.usd | ceil }}{%- elsif offer.price contains '€' and offer.price != '' -%}{{ offer.price | remove: '€' | times: site.eur | ceil }}{%- else -%}{{ offer.price }} {%- endif -%}{%- endif -%},'{%- include footer/phone.html legal=offer.phone name=names type="text" -%}','{{ offer.link }}']{%- if forloop.last -%}{%- else -%},{%- endif -%}{%- endfor -%}]; L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{maxZoom:17,attribution:'<a href="{{ site.main_url }}" target="_blank">{{ site.title }}</a> - {{ breadcrumb }}',tileSize:512,zoomOffset:-1,subdomains:['a','b','c']}).addTo(map); map.attributionControl.setPrefix(''); {%- include map/left-menu-map.html -%} var markersClusters = L.markerClusterGroup(); for (var i = 0; i < markers.length; i++) { var re = markers[i]; var title = (re[2] || re[3]) ? re[2] + ' ' + re[3] : ''; var titleLink = (re[9] && re[9] != '') ? '<a href="' + re[9] + '">' + re[2] + ' ' + re[3] + '</a>' : re[2] + ' ' + re[3]; var rooms = (re[5] && re[5] != '') ? ', {{ site.data.uk.re_rooms }} ' + re[5] : ''; var description = ',<br/>{{ site.data.uk.re_surface }} ' + re[4] + ' {{ site.data.uk.m }}' + rooms + ',' + re[6] + '<br/>{{ site.data.uk.re_cost }} ' + re[7] + ' {{ site.data.uk.re_uah }},<br/>{{ site.data.uk.re_tel }} ' + re[8]; var marker = L.marker(new L.LatLng(re[0],re[1]),{title:title}); marker.bindPopup(titleLink + description); markersClusters.addLayer(marker); } map.addLayer(markersClusters);setTimeout(function(){map.fitBounds(markersClusters.getBounds());},5);</script>
  {%- else -%}
    <script>var map = L.map('map',{center:[{{ page.coordinates }}],minZoom:11,zoom:10}).setView([{{ page.coordinates }}],10); L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{maxZoom:18,attribution:'<a href="{{ site.main_url }}" target="_blank">{{ site.title }}</a> - {{ breadcrumb }}',tileSize:512,zoomOffset:-1}).addTo(map); map.attributionControl.setPrefix(''); L.marker([{{ page.coordinates }}]).addTo(map).bindPopup('<b>{{ breadcrumb }}</b>').openPopup(); {%- include map/left-menu-map.html -%}</script>
  {%- endif -%}
{%- endif -%}
